<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>V10 Blue Dragon Overlay - @katilbebek</title>
    <script src="/socket.io/socket.io.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap" rel="stylesheet">
    <style>
        /* EKRAN AYARLARI */
        body { margin: 0; overflow: hidden; background: transparent; font-family: 'Oswald', sans-serif; }
        #overlay-container { position: relative; width: 100vw; height: 100vh; pointer-events: none; }

        /* TEST PANELİ (SAĞ TARAF) */
        #test-panel { 
            position: fixed; right: 20px; top: 50%; transform: translateY(-50%);
            background: rgba(0, 10, 20, 0.9); border: 2px solid #00d4ff;
            padding: 20px; border-radius: 15px; pointer-events: auto; z-index: 9999;
            width: 200px; text-align: center; box-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
        }
        #test-panel h3 { color: #00d4ff; margin-top: 0; font-size: 16px; text-transform: uppercase; }
        .test-btn { 
            width: 100%; padding: 10px; margin: 5px 0; border: none; border-radius: 5px;
            cursor: pointer; font-weight: bold; font-family: 'Oswald'; transition: 0.3s;
        }
        .btn-follow { background: #1da1f2; color: white; }
        .btn-like { background: #ff0055; color: white; }
        .btn-gift { background: #ffaa00; color: black; }
        .test-btn:hover { transform: scale(1.05); filter: brightness(1.2); }

        /* REKLAM ALANI */
        #ads { color: #555; font-size: 12px; margin-top: 15px; }
        #ads a { color: #00d4ff; text-decoration: none; }

        /* EJDERHA VE TEXT ANİMASYONLARI (Senin v10 Efektlerin) */
        .event-node { position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); text-align: center; }
        .dragon-gif { width: 500px; }
        .event-text { color: white; font-size: 50px; text-shadow: 0 0 20px #00d4ff, 0 0 40px #00d4ff; display: block; }
        .combo-text { color: #ff0055; font-size: 70px; font-style: italic; }
    </style>
</head>
<body>

    <div id="overlay-container"></div>

    <div id="test-panel" id="panel-hide">
        <h3>V10 TEST MENÜSÜ</h3>
        <button class="test-btn btn-follow" onclick="simulate('follow')">TAKİP TEST</button>
        <button class="test-btn btn-like" onclick="simulate('like')">100 PENÇE TEST</button>
        <button class="test-btn btn-gift" onclick="simulate('gift', 'Tea')">TEA (ÇAY) TEST</button>
        <button class="test-btn btn-gift" onclick="simulate('gift', 'Rose')">ROSE (GÜL) TEST</button>
        
        <div id="ads">
            SATIN AL: <br>
            <a href="https://t.me/katilbebek" target="_blank">@katilbebek Telegram</a>
        </div>
        <p style="font-size: 10px; color: #333;">OBS'de bu panel görünmez.</p>
    </div>

<script>
    const socket = io();
    const container = document.getElementById('overlay-container');
    
    // URL'den kullanıcı adını al
    const urlParams = new URLSearchParams(window.location.search);
    const username = urlParams.get('k');
    if (username) {
        socket.emit('set-user', username);
    }

    // TEST FONKSİYONU
    let comboCount = 0;
    function simulate(type, giftName = '') {
        let mockData = {
            uniqueId: 'TestUser',
            type: type,
            text: type === 'follow' ? 'TAKİP ETTİ!' : (type === 'like' ? '100 PENÇE ATTI!' : giftName.toUpperCase() + ' GÖNDERDİ!'),
            giftName: giftName
        };

        if (type === 'gift') {
            comboCount++;
            mockData.combo = comboCount;
            // Gül ise kombo yap, Çay ise direkt göster gibi mantık kurabilirsin
        } else {
            comboCount = 0;
        }
        
        showEvent(mockData);
    }

    // EVENT GÖSTERİMİ
    socket.on('event', (data) => {
        showEvent(data);
    });

    function showEvent(data) {
        const div = document.createElement('div');
        div.className = 'event-node';
        
        // Kombo varsa metni güncelle
        let comboHtml = data.combo ? `<div class="combo-text">KOMBO x${data.combo}</div>` : '';

        div.innerHTML = `
            <img src="https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExNHJueGZ3bmZ3bmZ3bmZ3bmZ3bmZ3bmZ3bmZ3bmZ3bmZ3bmZ3JmVwPXYxX2ludGVybmFsX2dpZl9ieV9pZCZjdD1z/3o7TKMGpxx6xY2H5T2/giphy.gif" class="dragon-gif">
            <div class="event-text">@${data.uniqueId}</div>
            <div class="event-text">${data.text}</div>
            ${comboHtml}
        `;

        container.appendChild(div);
        setTimeout(() => div.remove(), 4000);
    }

    // OBS'de sağ paneli gizleme (Opsiyonel: Kullanıcı isterse kapatır)
    if(window.location.search.includes('hide=true')) {
        document.getElementById('test-panel').style.display = 'none';
    }
</script>
</body>
</html>
